<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Zenchain NFT Minter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
      color: #fff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    h1 {
      margin-bottom: 10px;
      font-size: 2.2rem;
      text-align: center;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
    }

    #acc {
      margin-bottom: 20px;
      font-weight: 600;
    }

    .card {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 20px;
      width: 100%;
      max-width: 500px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.3);
      margin-bottom: 20px;
    }

    button {
      padding: 12px 20px;
      margin: 10px 0;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 700;
      background: #1abc9c;
      color: #fff;
      transition: 0.3s;
    }

    button:hover {
      background: #16a085;
    }

    input {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: none;
      margin-bottom: 10px;
    }

    #status {
      margin-top: 15px;
      white-space: pre-wrap;
      font-size: 0.95rem;
      background: rgba(255,255,255,0.1);
      padding: 10px;
      border-radius: 8px;
    }

    #mintedCounter {
      font-weight: bold;
      margin-top: 10px;
      font-size: 1rem;
      color: #ffeb3b;
    }
  </style>
</head>
<body>

  <h1>Zenchain NFT Minter</h1>
  <p id="acc">Not connected</p>

  <div class="card">
    <button id="connect">Connect Wallet</button>

    <label for="tokenSelect">Choose NFT to Mint:</label>
    <select id="tokenSelect">
      <option value="https://raw.githubusercontent.com/YOUR_USERNAME/zenchain-nft-minter/main/metadata/1.json">ZenNFT #1</option>
      <option value="https://raw.githubusercontent.com/YOUR_USERNAME/zenchain-nft-minter/main/metadata/2.json">ZenNFT #2</option>
      <option value="https://raw.githubusercontent.com/YOUR_USERNAME/zenchain-nft-minter/main/metadata/3.json">ZenNFT #3</option>
      <option value="https://raw.githubusercontent.com/YOUR_USERNAME/zenchain-nft-minter/main/metadata/4.json">ZenNFT #4</option>
    </select>

    <button id="mint">Mint NFT</button>

    <div id="status">Status will appear here...</div>
    <div id="mintedCounter">Total Minted: 0</div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
  <script>
    const CONTRACT_ADDRESS = "REPLACE_WITH_DEPLOYED_CONTRACT_ADDRESS"; // <-- Replace with your deployed ZenNFT address
    const CONTRACT_ABI = [
      {"inputs":[{"internalType":"string","name":"uri","type":"string"}],"name":"mint","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},
      {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":true,"internalType":"uint256","name":"tokenId","type":"uint256"}],"name":"Transfer","type":"event"}
    ];

    let provider, signer, contract;
    let totalMinted = 0;

    async function connect() {
      const status = document.getElementById('status');
      try {
        if (!window.ethereum) {
          status.innerText = 'MetaMask not detected. Please install MetaMask.';
          return;
        }
        provider = new ethers.providers.Web3Provider(window.ethereum);
        await provider.send("eth_requestAccounts", []);
        signer = provider.getSigner();
        const addr = await signer.getAddress();
        document.getElementById('acc').innerText = 'Connected: ' + addr;
        contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);
        status.innerText = 'Wallet connected! Ready to mint. Make sure MetaMask is on Zenchain testnet.';
      } catch (err) {
        status.innerText = 'Connection error: ' + (err?.message || err);
      }
    }

    async function mint() {
      const status = document.getElementById('status');
      const selectedURI = document.getElementById('tokenSelect').value;
      if (!contract) { status.innerText = 'Connect wallet first!'; return; }

      try {
        status.innerText = 'Sending transaction... Confirm in MetaMask.';
        const tx = await contract.mint(selectedURI);
        status.innerText = 'Transaction sent! Tx hash: ' + tx.hash + '\nWaiting for confirmation...';
        const receipt = await tx.wait();

        let tokenId = null;
        if (receipt && receipt.events) {
          for (const e of receipt.events) {
            if (e.event === 'Transfer' && e.args?.tokenId) {
              tokenId = e.args.tokenId.toString();
              break;
            }
          }
        }

        totalMinted += 1;
        document.getElementById('mintedCounter').innerText = 'Total Minted: ' + totalMinted;

        status.innerText = 'Mint confirmed!\nTx: ' + tx.hash + (tokenId ? '\nToken ID: ' + tokenId : '');
      } catch (err) {
        console.error(err);
        status.innerText = 'Error: ' + (err?.message || err);
      }
    }

    document.getElementById('connect').addEventListener('click', connect);
    document.getElementById('mint').addEventListener('click', mint);
  </script>
</body>
</html>
